\documentclass[a4paper, 12pt]{article}

%\usepackage{natbib}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}

% Expectation symbol
\DeclareMathOperator*{\E}{\mathbb{E}}

\begin{document}


\section{Introduction}

This paper presents an algorithm for surface classification using millimeter-wave radar. 

Fundamentally, radar is based on the concept of transmitting and recieving electromagnetic radiation. Radar response will be highly dependant on the surrounding region of the sensor, as objects in its vicinity scatter transmitted waves differently \cite{richards_2014}.  

 As technolgy is becoming increasingly intertwined with everyday life a multitude of new areas for smart sensing has opened up. One sensor category that has been recieving much attention is radars with very high frequency. These sensors combine a multitude of desirable features packed into a favorable form factor . These capabilities has made high frequency radars an increasingly popular choice in a steadily growing number of applications, such as monitoring of vital signs \cite{kuo_lin_yu_lo_lyu_chou_chuang_2016}, gesture recognition \cite{lien_gillian_karagozler_amihood_schwesig_olson_raja_poupyrev_2016}

Alongside with this development another trend within data science has emerged; the movement towards machine learning centric methods. Machine learning algorithms fundamentally utilizes various statistical techniques in order to allow computer systems to progressively improve performance. Data scientists have found this subclass of aritficial intelligence extremely practical, especially for data that lack an easily predictable structure. 
%A notable recent example where machine learning has proven to be essential is within the field of autonomous driving. Here, a multitude of different sensors such as cameras, radars and ultrasonic sensors generate a massive amount of data every second that requires interpretation. Information about a passing car is extracted from this complex output of images and ultrasonic responses accurately and robustly. 
\\ \\
The amount of millimetre-wave radar applications is growing steadily.

With a continuously increasing demand for small sensors for use in a world where 

The number of new application areas that are based on millimetre based radar sensor is continou

\subsection{Motivation}

Classification of surfaces is an important task. It appears in many areas.
\\ \\
You can determine surfaces in many different ways - optical, probing etc.
\noindent Optical: Recent advancements in neural networks. 
\noindent Probing: One may also measure directly onto a surface directly through a probing approach. \\
\noindent Interfering: Induced surface vibrations generating sound which can be detected and classified  \cite{strese_schuwerk_iepure_steinbach_2017}.
\\ \\
It is often desirable to to this without direct contact i.e. probing
\\ \\
Radar has successfully been used to for example locate salt in the ground
\\ \\
These radars commonly have wavelenghts of something something
\\ \\
If we however want to classify surface materials using a much shorter wavelength, the task changes dramatically as apsorption is near-instant. 
\\ \\
Something about radar wavelenght categories
\\ \\
Furthermore, radar sensors are commonly used in an array setting which permits beamforming and extraction of spatial information. 
\\ \\
If one on the other hand only has a singular radar sensor this is not possible and you must resort to other means.
\\ \\
Probably want something about IQ demodulation somewhere in here.

\subsection{Problem formulation}

We develop a pipeline for effectively solving this problem. 
\\ \\
We present modelling options with high accuracy and efficacy. 
\\ \\ 
We present results based on a 60GHz Acconeer micro radar. 
\\ \\
In this paper we introduce means of surface identification based on the output from a single 60 GHz radar sensor moving across a surface with constant height. 

\subsection{Thesis outline}

Chapter 2: We present a radar systems overview and introduce some crucial concepts for understanding the radar output used in this work. 
\\ \\
Chapter 3: Feature selection and preprocessing is considered. Signal structure is discussed primarily on an intuitive level. 
\\ \\
Chapter 4: Classification schemes. Moving from simple to advanced, some classifiers of special interest are investigated. Results with regards to these classifiers are presented.
\\ \\
Chapter 5: Disucssion.
\\ \\
Chapter 6: Conclusion.

\section{Chapter 2: Radar system overview}

In this chapter we introduce three fundamental radar concepts which will be important for understanding future feature selection discussions. 
\\ \\
The radar equation.
\\ \\
The matched filter.
\\ \\
The IQ demodulation scheme. 
\\ \\
The radar system used for this project is a 60 GHz radar developed by Acconeer AB.
\\ \\
An antenna transmits a wavelet signal towards an object of interest. After a brief period of time a second wavelet signal is generated and \emph{mixed} with data from a recieving antenna. This procedure is repeated, every time slightly delaying the generation of the second wavelet and thus mixing with a different section of the incoming pulse. 
\\ \\
Throgh this methodology we can effectively produce

\subsection{The radar principle}

The radar principle is at its core simple.  A wavelet pulse $x_T(t)$ with some carrier frequency $\Omega$  is transmitted towards an object of interest. 

etc etc..


\subsection{Matched filter}

something something desired frequency response of the recieving antenna. 

In any radar system a good Signal-to-Noise Ratio (SNR) is a highly desired property. Finding a reciever frequency response which maximizes SNR is thus an important topic. Denoting the reciever output as $y(t)$ and the incoming waveform as $x(t)$ the output spectrum will be a convolution of $x(t)$ and the system impulse response $h(t)$, or conversely a multiplication in the frequency domain $Y(\Omega) = X(\Omega)H(\Omega)$. If we seek to maximize SNR at some arbitrary point in time $T_M$ the power at that very instant is
%
\begin{equation}
	|y(T_M)|^{2} = |\frac{1}{2\pi}\int X(\Omega)H(\Omega)e^{j\Omega T_M} d\Omega|^{2}.
\end{equation}

Now we consider interference in the form of spectrally flat noise with power spectral density $\sigma^2$ W/Hz. The SNR $\xi$ measured at time $T_M$ can then be described as the ratio between the total signal power and the total noise power
%
\begin{equation}
	\xi
	= \frac{|y(T_M)|^{2}}{(1/2\pi)\int|\sigma H(\Omega)|^{2}d\Omega}
	= \frac{|(1/2\pi)\int X(\Omega)H(\Omega)e^{j\Omega T_M}d\Omega|^2}{(\sigma^2/2\pi)\int|H(\Omega)|^{2}d\Omega}
\end{equation}
%
which clearly depends on which reciever response is used. It can from above expression be shown [reference] that the maximum $\xi$ is obtained when 
%
\begin{gather}
 H(\Omega) = \alpha X*(\Omega)e^{j\Omega T_M}, \text{ or} \\
\label{eq:123}
h(t) = \alpha x^*(T_M - t)
\end{gather}
%
where $\alpha$ is an arbitrary constant which has no impact on the resulting SNR. Examining $h(t)$ above we see that the optimal filter for maximizing SNR is when the coefficients consist of the transmitted waveform conjugated and time-reversed. This filter is called a \emph{matched filter} due to the symmetrical relationship between waveform and impulse response.

One way of interpreting the matched filter is by viewing the filtering as a correlation. If we denote $\bar{x}(t)$ as the sum of both target and noise components the output $y(t)$ is given by
%
\begin{equation}
	y(t) = \int \bar{x}(s)h(t-s)ds = \alpha\int \bar{x}(s)x^*(s + T_M - t)ds
\end{equation}
%
which is recognized as the cross-correlation between noisy signal $\bar	{x}(t)$ and transmitted waveform $x(t)$ evaluated at lag $T_M-t$. By shifting the constant lag $T_M$ we then can obtain the full cross-correlation 


\subsection{IQ demodulation}

IQ "amplifies" phase information
\\ \\
Phase information is more detailed over time
\\  \\
We sample really often
\\ \\
That might be good for us
\\ \\
IQ splits into two channels, interpreted as real and complex
\\ \\





A common type of data when working with radar signal processing is IQ-data (in- and quadrature phase).  This type of data is useful in that it contains information not only about amplitude, but about the phase of the radar signal as well. In particular, this is good for situations where small changes in the radar signal need to be detected, (Mention a case such as recording over grass...) as the phase is more sensitive to changes than the amplitude. Due to the high phase sensitivity, a high sampling rate is required or the recorded phase data will just appear to be fluctuating randomly over time.

IQ-data is derived by having the RF-signal, received from the radar, multiplied with a generated sinusoid of the same frequency. This is done twice to separate the signal into the I- and Q-parts of the data. In one of the multiplications, the generated sinusoid is shifted 90 degrees in phase. 

IQ-data is derived through a process commonly known as IQ- or quadrature-demodulation. To describe the process mathematically,  the RF-signal received from the radar is described as $s(t) = A(t)\sin(2\pi ft+\phi(t))$. To be able to uniquely determine $\phi(t)$ later, the signal is multiplied separately by two sinusoids shifted 90 degrees in phase relative to eachother, yielding
\begin{gather}
	s_1(t) = \sin(2\pi ft+\phi(t))A(t)\sin(2\pi ft+\phi(t)) \\
	s_2(t) = \cos(2\pi ft+\phi(t))A(t)\sin(2\pi ft+\phi(t)).
\end{gather}

\begin{equation}
	\label{eq:IQtrig}
	\cos(\alpha+\beta) = \cos(\alpha)\cos(\beta)-\sin(\alpha)\sin(\beta)
\end{equation}
By means of low pass filtering, the following signal is then obtained
\begin{equation}
	s_{lp}(t)=A(t)\cos(\phi)-A(t)\sin(\phi).
\end{equation}
From this expression, the in-phase and quadrature phase (I and Q) are defined as $I(t)=A(t)\cos(\phi)$ and $Q(t)=A(t)\sin(\phi)$. Henceforth in this report, IQ-data will refer to complex numbers of the form $I+i Q$. Note that taking the absolute value of such a complex number yields the amplitude, $A$.

The above result is implemented in hardware according to figure (....). The RF signal is split up in two channels. In each of the channels it is mixed with a wave generated by an oscillator. In one of the channels, the generated wave is shifted 90 degrees. A low pass filter then shapes the final $I$- and $Q$-components


\section{Chapter 3: Feature selection}

In order to make sense of data one must impose some reasonable assumptions. 
\\ 
One idea is to view each measurement, taken at time instance $t$ at range $r$ for material $m$, as drawn from some 
complex distribution specific for that combination of $r$ and $s$ but independent of time of sampling $t$. 
\\
Yada yada there is two combatting ideas here

\subsection{Preprocessing}

\subsubsection{Downsampling}

Since the correlation between neighboring range samples is very high we can downsample without significant loss of information. The downsampling process essentially require three hyperparameters: A starting range $R_{start}$ and an end range $R_{end}$ where we begin and end our downsampling process respectively, as well as a downsampling factor $D$.

\begin{equation}
	x_D(n, t) = x(R_{start} + nD, t) \quad \text{for}\quad n=1...\frac{R_{end}-R_{start}}{D}
\end{equation}

\subsubsection{Using multiple sweeps for feature selection}

In the radar system multiple sources of noise are introduced.
\\ \\
List some noise sources.
\\ \\
In the beginning section of this chapter we introduced two conflicting interpretations of the radar signal. In the first the incomming wavelet is drawn from a complex distribution, and each sweep is independent from the rest. In the second we instead considered that there may be some significant correlations in time to take into account; surface shapes and objects passing by the sensor are detected multiple times in a perhaps predictable and useful manner.  

The first suggest that signal averaging over a number of sweeps should yield a more and more accurate estimate. Thus the first approach greatly benefit from using multiple sweeps to find an average over some predefined number of sweeps.  In order to utilize the time correlations assumed in the second interpretation processing in time is of course demanded, and a number of sweeps need to be analyzed at once to extract features related to this way of viewing the radar response. 

Thus a predefined number is chosen as the number of sweeps used to extract each feature. While each feature may be extracted with higher accuracy, it is done at the price of a lower number of classifications per second. The relation between classification rate $F_c$, sampling speed $F_s$ and sweeps per feature $T_s$ is

\begin{equation}
	F_c = \frac{F_s}{T_s}
\end{equation}


\subsection{Used features}

Fast time and slow time features 

\subsubsection{Average sweep energy}

\begin{equation}
	P(t_m) = \frac{1}{NT}\sum_{t=0}^{T-1}\sum_{n=0}^{K-1}x(n, t_m + t)x^*(n, t_m + t)
\end{equation}

\subsubsection{Expected signal}

\begin{equation}
	s_i(t_m) = \E\{X_{i,t_m}\} = \frac{1}{T}\sum_{t=0}^{T-1}x(i, t_m + t)
\end{equation}


\subsubsection{Fourier Transform}
First explain how FFT is used, then show that FFT causes aliasing. Possibly include plots that visualize the aliasing.


Sampling at 150 Hz and moving at 0.3m/s gives a maximal speed component of 0.15m/s, directed straight towards the sensor. This is notated $v_{\perp}$. The nyquist frequency is half the sampling frequency, i.e. $f_N=75$ Hz. From moving an "object" straight towards the sensor with speed $v_{\perp}$ we get a doppler frequency $f_d = \frac{2v_{\perp}}{\lambda}$. Comparing $f_d$ with $f_N$, we see that $f_d$ is greater, meaning we will have aliasing.

There is still information in the FFT, and it can be used as features. Although the parts which are aliased will be jumping around in the spectra and act as noise. Hence not an ideal approach.

* Figure showing how $v_\perp$ is defined. mark velocities and possibly other variables.*



\subsubsection{Variance}

Include a discussion about the biased/unbiased estimate \\

Assume $x(n,t)$ are samples from a complex normal distribution $X_{n,t}$. Variance $v_i(t_m)$ at range $i$ at time $t_m$ can then be approximated using

\begin{equation}
\label{eq:var}
\begin{gathered}
	v_i(t_m) = \E\{ (X_{i,t_m} - \E\{X_{i,t_m}\})^2\} \\
	= \frac{1}{T-1}\sum_{t=0}^{T-1}(x(i, t_m + t) - s_i(t_m))^*(x(i, t_m + t) -  s_i(t_m))
\end{gathered}
\end{equation}

\subsubsection{Autocovariance in slow time}

\textbf{Add some motivation for using autocovariance}

\noindent
For some stochastic process $P_t$ we can define the autocovariance $\gamma$ as

\begin{equation}
	\gamma(t, s) = \E\big\{(P_t - \mu_t)(P_s - \mu_s)\big\}
\end{equation}

If $X_t$ is a weakly stationary process the first moment (mean) and autocovariance do not vary over time.  The autocovariance then only depends on the difference between $s$ and $t$, making it possible to rewrite as

\begin{equation}
	\gamma(\tau) = \E\big\{(P_t - \mu)(P_{t+\tau} - \mu)\big\}
\end{equation}

Assuming weak stationarity over a few rangebins we can estimate the autocovariance in slow time for each selected range. 

\begin{equation}
\begin{gathered}
	\gamma_i(t_m, \tau) = \E\big\{(X_{i,t_m} - \E\{X_{i, t_m}\})^*(X_{i, t_m+\tau} - \E\{X_{i, t_m+\tau}\})\big\}\\
	= \frac{1}{T-1}\sum_{t=0}^{T-1-\tau}(x(i, t_m + t) - s_i(t_m))^*(x(i, t_m + t + \tau) - s_i(t_m + \tau))
\end{gathered}
\end{equation}•

We can drop the $\tau$ in the final expectation term, as $s_i(t)$ are estimated in batch from $t_m$ to  $t_m + T$ yielding

\begin{equation}
	\gamma_i(t_m, \tau) = \frac{1}{T-1}\sum_{t=0}^{T-1- \tau}(x(i, t_m + t) - s_i(t_m))^*(x(i, t_m + t + \tau) - s_i(t_m))
\end{equation}
as our expression for autocovariance. Note that the variance in \ref{eq:var} collapses to the autocovariance at 0 lag. 


\section{Chapter 4: Classification schemes}

\section{Chapter 5: Discussion}


\subsection{Moisture}

One particularly challenging aspect of adequately classifying surfaces is the ever-changing environmental conditions surronding the sensor. Of particular interest is the moisture content in the surfaces of interest. Greater soil moisture implies higher dielectric constant, which in turn increases radar wave scattering \cite{rappaport_2006}. Thus a single surface may very well change its scattering properties over time. 

% More things that make selecting data tricky

\subsection{Surface variances}

Such effects is difficult to account for when selecting data. Gather a dataset as diverse as possible

\subsection{Individual sensor performance}
Despite the fact that the radar sensors have high precision, the output can vary a lot from sensor to sensor. In particular, one sensor can have a significantly higher gain than another, meaning that two sensors can have a different measure of reflexivity on the very same surface. 

\bibliographystyle{plain}
\bibliography{refs}


\end{document}
